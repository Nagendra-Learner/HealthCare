<div class="container mt-5">
  <h3 class="text-center mb-4">Change Password</h3>
  <form [formGroup]="changeForm" (ngSubmit)="onSubmit()">

    <!-- Username -->
<div class="mb-3">
  <label for="email" class="form-label"><span style="color:red">*</span> Email </label>
  <input type="email" id="email" class="form-control" formControlName="email" placeholder="Enter your email">
  <div *ngIf="f['email'].invalid && f['email'].touched" class="text-danger small mt-1">
    <small *ngIf="f['email']?.errors?.['required']">Email is required</small>
    <small *ngIf="f['email']?.errors?.['email']">Enter a valid email</small>
  </div>
</div>

    <!-- Old Password -->
    <div class="mb-3">
      <label for="oldPassword" class="form-label"><span style="color:red">*</span> Old Password</label>
      <input type="password" id="oldPassword" class="form-control" formControlName="oldPassword" placeholder="Enter old password">
      <div *ngIf="f['oldPassword'].invalid && f['oldPassword'].touched" class="text-danger small mt-1">
        <small *ngIf="f['oldPassword']?.errors?.['required']">Old password is required</small>
      </div>
    </div>

    <!-- New Password -->
    <div class="mb-3">
      <label for="newPassword" class="form-label"><span style="color:red">*</span> New Password</label>
      <input type="password" id="newPassword" class="form-control" formControlName="newPassword" placeholder="Enter new password">
      <div *ngIf="f['newPassword'].invalid && f['newPassword'].touched" class="text-danger small mt-1">
        <small *ngIf="f['newPassword']?.errors?.['required']">New password is required</small>
        <small *ngIf="f['newPassword']?.errors?.['minlength']">Minimum 8 characters.</small>
        <small *ngIf="f['newPassword']?.errors?.['pattern']">Password must contain at least one uppercase, one lowercase, one digit, one special character, and be at least 8 characters long.</small>
      </div>
    </div>

    <!-- Confirm Password -->
    <div class="mb-3">
      <label for="confirmPassword" class="form-label"><span style="color:red">*</span> Confirm New Password</label>
      <input type="password" id="confirmPassword" class="form-control" formControlName="confirmPassword" placeholder="Confirm new password">
      <div *ngIf="f['confirmPassword'].invalid && f['confirmPassword'].touched" class="text-danger small mt-1">
        <small *ngIf="f['confirmPassword']?.errors?.['required']">Confirm password is required</small>
      </div>
      <div *ngIf="passwordMismatch" class="text-danger small mt-1">
        <small>Passwords do not match</small>
      </div>
    </div>

    <button type="submit" [disabled]="changeForm.invalid" class="btn btn-dark w-100">Update Password</button>
  </form>

  <div class="text-center">
    <a routerLink = "/login">Login</a>
  </div>

  <div *ngIf="message" class="alert alert-info mt-3">{{ message }}</div>
  <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center mt-3">
          <i class="bi bi-exclamation-triangle-fill me-2"></i>
          <div>{{ errorMessage }}</div>
        </div>
</div>