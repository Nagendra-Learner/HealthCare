<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
      <div class="card shadow-sm">
        <div class="card-body">
          <h3 class="text-center mb-4">ðŸ”’ Change Password</h3>
          <form [formGroup]="changeForm" (ngSubmit)="onSubmit()">

            <!-- Email -->
            <div class="mb-3">
              <label for="email" class="form-label"><span class="text-danger">*</span> Email</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                <input type="email" id="email" class="form-control" formControlName="email" placeholder="Enter your email">
              </div>
              <div *ngIf="f['email'].invalid && f['email'].touched" class="text-danger small mt-1">
                <small *ngIf="f['email']?.errors?.['required']">Email is required</small>
                <small *ngIf="f['email']?.errors?.['email']">Enter a valid email</small>
              </div>
            </div>

            <!-- Old Password -->
            <div class="mb-3">
              <label for="oldPassword" class="form-label"><span class="text-danger">*</span> Old Password</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-lock"></i></span>
                <input type="password" id="oldPassword" class="form-control" formControlName="oldPassword" placeholder="Enter old password">
              </div>
              <div *ngIf="f['oldPassword'].invalid && f['oldPassword'].touched" class="text-danger small mt-1">
                <small *ngIf="f['oldPassword']?.errors?.['required']">Old password is required</small>
              </div>
            </div>

            <!-- New Password -->
            <div class="mb-3">
              <label for="newPassword" class="form-label"><span class="text-danger">*</span> New Password</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-shield-lock"></i></span>
                <input type="password" id="newPassword" class="form-control" formControlName="newPassword" placeholder="Enter new password">
              </div>
              <div *ngIf="f['newPassword'].invalid && f['newPassword'].touched" class="text-danger small mt-1">
                <small *ngIf="f['newPassword']?.errors?.['required']">New password is required</small>
                <small *ngIf="f['newPassword']?.errors?.['minlength']">Minimum 8 characters.</small>
                <small *ngIf="f['newPassword']?.errors?.['pattern']">Password must contain at least one uppercase, one lowercase, one digit, one special character.</small>
              </div>
            </div>

            <!-- Confirm Password -->
            <div class="mb-3">
              <label for="confirmPassword" class="form-label"><span class="text-danger">*</span> Confirm New Password</label>
              <div class="input-group">
                <span class="input-group-text"><i class="bi bi-check2-circle"></i></span>
                <input type="password" id="confirmPassword" class="form-control" formControlName="confirmPassword" placeholder="Confirm new password">
              </div>
              <div *ngIf="f['confirmPassword'].invalid && f['confirmPassword'].touched" class="text-danger small mt-1">
                <small *ngIf="f['confirmPassword']?.errors?.['required']">Confirm password is required</small>
              </div>
              <div *ngIf="passwordMismatch" class="text-danger small mt-1">
                <small>Passwords do not match</small>
              </div>
            </div>

            <button type="submit" [disabled]="changeForm.invalid" class="btn btn-dark btn-sm w-100">Update Password</button>
          </form>

          <div class="text-center mt-3">
            <a routerLink="/dashboard" class="btn btn-outline-secondary btn-sm">Go to Dashboard</a>
          </div>

          <div *ngIf="message" class="alert alert-info mt-3">{{ message }}</div>
          <div *ngIf="errorMessage" class="alert alert-danger d-flex align-items-center mt-3">
            <i class="bi bi-exclamation-triangle-fill me-2"></i>
            <div>{{ errorMessage }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>